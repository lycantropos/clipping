dist: xenial

language: python

matrix:
  include:
    - python: pypy3.5-7.0.0
    - python: pypy3.6-7.1.1
    - python: 3.5
    - python: 3.6
    - python: 3.7
    - python: 3.8

install:
  - python -m pip install --upgrade pip setuptools
  - python -m pip install --upgrade codecov
  - python -m pip install --force-reinstall -r requirements.txt
  - python -m pip install --force-reinstall -r requirements-tests.txt

script:
  - pytest
  - python -m doctest README.md

after_success:
  - python -m codecov -f coverage.xml -X gcov

deploy:
  provider: pypi
  on:
    tags: true
    python: 3.5
  user: __token__
  password:
    secure: L7yTOQt+OhhPm7CrqMLfHShcRp+B/2TslY/1BCTIVXRakhX43fdzaa/QFO5M+DUHvKSwOqFflyCkzK0I58ll6/gfD56lGhJR09rArlCeUmPyVAN2EX6ashQ1q/W3XS7GY1IRPyR9zTyUiHEiMJY6FdEE6jkEztNl2M3FqZpfa9aR2ztihkzliVncQWbFRPrI0zgzt6WPI8is26t2thVbKvQjT8DpPkUf53HqY0r08aWOBIUnUrX9kuYlaX6//sZRcAJxiyHR0nyoXC26eBDkyUA6CDEQcr7UNC/L36k4R75K8e1ps39Xr8UfqId+zwZjORUU4twQ4vfwqzqxuuipoPyNHDzpBzSS9H/1+rXB2JfxmcgfeXlam8H/tEvtsv9ejx5c329XpgY64QHj+pgOyw6HaBxioQz9OjG396+bb9uQoBr+GeIu8ORhAEtK7U9BnphjaYwGddJepra0wMTdb8qZpOt25Ajn8g6oZGl0c8sg/E+d6kmRu8Ex3al/d7AB0bxRVk0vAtUZQ7k7a5w8v+BhB82DJ7J52tvaOgOLzf8eat0BQ9+cYtFbsCf6hlnBZ18A7bU1NqX8RqN36xZtl9xEBXF/LbP+KjUYAW3J19D9nX3RjxxQHr9irXQB/5UGyAygS2/BlL8ZKu8JiFwZeCiy6J3lDZxgI7TpiEptnOc=
  distributions: sdist bdist_wheel
  skip_existing: true
